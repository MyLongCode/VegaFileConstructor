@model List<Generation>
@{
    var templates = ViewBag.Templates as List<DocumentTemplate> ?? [];
}
<h2>История генераций</h2>
<form class="row g-2 mb-3" method="get">
    <div class="col-md-3">
        <select name="TemplateId" class="form-select">
            <option value="">Все шаблоны</option>
            @foreach (var t in templates) { <option value="@t.Id">@t.Name</option> }
        </select>
    </div>
    <div class="col-md-2"><select name="Status" class="form-select"><option value="">Все статусы</option><option>Created</option><option>Generated</option><option>Failed</option></select></div>
    <div class="col-md-2"><input type="date" name="DateFrom" class="form-control" /></div>
    <div class="col-md-2"><input type="date" name="DateTo" class="form-control" /></div>
    <div class="col-md-2"><button class="btn btn-outline-primary">Применить</button></div>
</form>
<table class="table table-striped">
<thead><tr><th>Дата/время</th><th>Тип документа</th><th>Статус</th><th></th></tr></thead>
<tbody>
@foreach (var g in Model)
{
<tr>
<td>@g.CreatedAt.ToLocalTime()</td>
<td>@g.Template?.Name</td>
<td>@g.Status</td>
<td>
<a class="btn btn-sm btn-outline-secondary" asp-action="Details" asp-route-id="@g.Id">Details</a>
@if (g.Status == GenerationStatus.Generated) { <a class="btn btn-sm btn-primary" asp-action="Download" asp-route-id="@g.Id">Download</a> }
</td>
</tr>
}
</tbody>
</table>
